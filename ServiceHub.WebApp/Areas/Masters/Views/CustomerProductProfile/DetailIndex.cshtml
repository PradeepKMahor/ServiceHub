@model ServiceHub.WebApp.Models.CustomerProductProfileDetailViewModel

@Html.AntiForgeryToken()

@{
    ViewData["Title"] = "Customer Product Profile Detail";

}
@section styles
{
    <link href="@Url.Content("~/css/drome-style.css")" rel="stylesheet" type="text/css" asp-append-version="true" />
    <link href="~/lib/dropzone/dropzone.css" rel="stylesheet" asp-append-version="true" />
    <link href="~/lib/dropzone/basic.css" rel="stylesheet" asp-append-version="true" />
    <style>
        @@media (-webkit-min-device-pixel-ratio: 1.25) {
            .openbal .col-xl-1, .closebal .col-xl-1 {
                flex: 0 0 12% !important;
                max-width: 12% !important;
            }
        }
    </style>
}
<input type="hidden" asp-for="CustomerID" />


@section BreadCrumbs
{
    <ol class="breadcrumb">
 <li class="breadcrumb-item "><a asp-action="Index" asp-controller="Home" asp-area="Masters">Masters</a></li>
        <li class="breadcrumb-item "><a asp-action="UserIndex" asp-controller="Home" asp-area="Masters">User Management</a></li>
        <li class="breadcrumb-item "><a asp-action="Index" asp-controller="CustomerProductProfile" asp-area="Masters">Customer Product Profile list</a></li>
        <li class="breadcrumb-item active" aria-current="page">Employee General Information</li>
    </ol>
}
<div class="col-sm-12">
    <div class="card bg-gray-active border rounded shadow m-auto ">
        <div class="card-block ">

            <div class="card-deck">
                <div class="card col-md-12 col-xl-12">
                    <div class="card-body">
                        <div id="divPrimaryDetails">
                            <div class="row p-2">
                                <div class="col-xl-4 col-md-6">
                                    <div class="form-group">
                                        <div class="dt-met">@Html.DisplayNameFor(model => model.CustomerID)</div>
                                        <div class="dd-met">
                                            @(Model.CustomerID)
                                        </div>
                                    </div>
                                </div>
                                <div class="col-xl-4 col-md-6">
                                    <div class="form-group">
                                        <div class="dt-met">@Html.DisplayNameFor(model => model.CustomerName)</div>
                                        <div class="dd-met">
                                            @(Model.CustomerName)
                                        </div>
                                    </div>
                                </div>
                                <div class="col-xl-4 col-md-6">
                                    <div class="form-group">
                                        <div class="dt-met">@Html.DisplayNameFor(model => model.CustomerGST)</div>
                                        <div class="dd-met">
                                            @(Model.CustomerGST)
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row p-2">
                                <div class="col-xl-4 col-md-6">
                                    <div class="form-group">
                                        <div class="dt-met">@Html.DisplayNameFor(model => model.ValidFromDate)</div>
                                        <div class="dd-met">
                                            @(Model.ValidFromDate  )
                                        </div>
                                    </div>
                                </div>
                                <div class="col-xl-4 col-md-6">
                                    <div class="form-group">
                                        <div class="dt-met">@Html.DisplayNameFor(model => model.ValidToDate)</div>
                                        <div class="dd-met">
                                            @( Model.ValidToDate)
                                        </div>
                                    </div>
                                </div>
                                <div class="col-xl-4 col-md-6">
                                    <div class="form-group">
                                        <div class="dt-met">@Html.DisplayNameFor(model => model.CountryCode)</div>
                                        <div class="dd-met">
                                            @(Model.CountryCode)
                                        </div>
                                    </div>
                                </div>
                                <div class="col-xl-4 col-md-6">
                                    <div class="form-group">
                                        <div class="dt-met">@Html.DisplayNameFor(model => model.Contact)</div>
                                        <div class="dd-met">@Html.DisplayFor(model => model.Contact)</div>
                                    </div>
                                </div>
                                <div class="col-xl-4 col-md-6">
                                    <div class="form-group">
                                        <div class="dt-met">@Html.DisplayNameFor(model => model.Email)</div>
                                        <div class="dd-met">@Html.DisplayFor(model => model.Email)</div>
                                    </div>
                                </div>
                                <div class="col-xl-4 col-md-6">
                                    <div class="form-group">
                                        <div class="dt-met">@Html.DisplayNameFor(model => model.CustomerAddress)</div>
                                        <div class="dd-met">@Html.DisplayFor(model => model.CustomerAddress)</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>

            <div class="card-pill" style="margin-top: 20px">
                <ul class="nav nav-tabs" id="tabs-tab" role="tablist">

                    <li class="nav-item">
                        <a class="nav-link" id="tabs-ProductDetails-tab" data-toggle="pill" href="#tabs-ProductDetails" role="tab" aria-controls="tabs-ProductDetails" aria-selected="true"
                           data-url="@Url.Action("ProductDetailIndex", "EmpGenInfoDetails", new { empno = "4444" })"
                           data-id="@Model.CustomerID"
                           data-divid="pw-ProductDetails"
                           data-callback="validateTabs()"
                           data-area="EmpGenInfo"
                           data-controller="EmpGenInfoDetails"
                           data-action="ProductDetailIndex">
                            Primary Details
                            <i id="imgDescriptionPrimaryStatus" class="fas fa-info-circle text-danger" style="display:none"></i>
                        </a>
                    </li>

                    <li class="nav-item">
                        <a class="nav-link" id="tabs-UserDetails-tab" data-toggle="pill" href="#tabs-UserDetails" role="tab" aria-controls="tabs-UserDetails" aria-selected="false"
                           data-url="@Url.Action("UsersDetails", "EmpGenInfoDetails", new { id = Model.CustomerID })"
                           data-id="@Model.CustomerID"
                           data-divid="pw-UserDetails"
                           data-callback="validateTabs()"
                           data-area="EmpGenInfo"
                           data-controller="EmpGenInfoDetails"
                           data-action="UsersDetailsEdit">
                            Secondary Details
                            <i id="imgDescriptionSecondaryStatus" class="fas fa-info-circle text-danger" style="display:none"></i>
                        </a>
                    </li>


                    <li class="nav-item">
                        <a class="nav-link" id="tabs-PMRDetails-tab" data-toggle="pill" href="#tabs-PMRDetails" role="tab" aria-controls="tabs-PMRDetails" aria-selected="false"
                           data-url="@Url.Action("PMRDetailsIndex", "EmpGenInfoDetails", new { id = Model.CustomerID })"
                          data-id="@Model.CustomerID"
                           data-divid="pw-PMRDetails"
                           data-area="EmpGenInfo"
                           data-controller="EmpGenInfoDetails"
                           data-callback="activateGratuityTab();"
                           data-action="PMRDetailsIndex">
                            PMR Details
                            <i id="imgDescriptionPMRStatus" class="fas fa-info-circle text-danger" style="display:none"></i>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" id="tabs-CMRDetails-tab" data-toggle="pill" href="#tabs-CMRDetails" role="tab" aria-controls="tabs-CMRDetails" aria-selected="false"
                           data-url="@Url.Action("CMRDetailsIndex", "EmpGenInfoDetails", new { id = Model.CustomerID })"
                           data-id="@Model.CustomerID"
                           data-divid="pw-CMRDetails"
                           data-area="EmpGenInfo"
                           data-controller="EmpGenInfoDetails"
                           data-callback="loadEmpCMRListDataTable();"
                           data-action="CMRDetailsIndex">
                            CMR Details
                            <i id="imgDescriptionCMRStatus" class="fas fa-info-circle text-danger" style="display:none"></i>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" id="tabs-WMRDetails-tab" data-toggle="pill" href="#tabs-WMRDetails" role="tab" aria-controls="tabs-WMRDetails" aria-selected="false"
                           data-url="@Url.Action("WMRDetails", "EmpGenInfoDetails",new { id = Model.CustomerID })"
                           data-id="@Model.CustomerID"
                           data-divid="pw-WMRDetails"
                           data-callback="validateTabs()"
                           data-area="EmpGenInfo"
                           data-controller="EmpGenInfoDetails"
                           data-action="EmployeeWMRDetails">
                            WMR Details
                            <i id="imgDescriptionPpAaStatus" class="fas fa-info-circle text-danger" style="display:none"></i>
                        </a>
                    </li>
                </ul>
                <div class="tab-content">
                   @*  @await Html.PartialAsync("_LoaderPartial")
 *@

                    <div class="tab-pane fade show active" id="tabs-ProductDetails" role="tabpanel" aria-labelledby="tabs-ProductDetails-tab">
                        <div id="pw-ProductDetails">
                        </div>
                    </div>
                    <div class="tab-pane fade" id="tabs-UserDetails" role="tabpanel" aria-labelledby="tabs-UserDetails-tab">
                        <div id="pw-UserDetails">
                        </div>
                    </div>
                    <div class="tab-pane fade" id="tabs-PMRDetails" role="tabpanel" aria-labelledby="tabs-PMRDetails-tab">
                        <div id="pw-PMRDetails">
                        </div>
                    </div>
                    <div class="tab-pane fade" id="tabs-CMRDetails" role="tabpanel" aria-labelledby="tabs-CMRDetails-tab">
                        <div id="pw-CMRDetails">
                        </div>
                    </div>
                    <div class="tab-pane fade" id="tabs-WMRDetails" role="tabpanel" aria-labelledby="tabs-WMRDetails-tab">
                        <div id="pw-WMRDetails">
                        </div>
                    </div>
                    <div class="tab-pane fade" id="tabs-AadhaarDetails" role="tabpanel" aria-labelledby="tabs-AadhaarDetails-tab">
                        <div id="pw-AadhaarDetails">
                        </div>
                    </div>
                    <div class="tab-pane fade" id="tabs-WMRAndAadhaarDetails" role="tabpanel" aria-labelledby="tabs-WMRAndAadhaarDetails-tab">
                        <div id="pw-WMRAndAadhaarDetails">
                        </div>
                    </div>
                    <div class="tab-pane fade" id="tabs-GTLIDetails" role="tabpanel" aria-labelledby="tabs-GTLIDetails-tab">
                        <div id="pw-GTLIDetails">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>
@section Scripts {

    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
        // await Html.RenderPartialAsync("_EmpGenInfoDataTableColumnsPartial", Model.LockStatusDetailViewModel, new ViewDataDictionary(ViewData) { { "IsOnBehalf", NotOk } });

    }
    <script src="~/lib/dropzone/dropzone.js" asp-append-version="true"></script>
    <script src="~/js/EmployeeGenInfo.js" asp-append-version="true"></script>

    <script>



        function flagUnflagTabsCallback(jsonData) {
            flagUnflagTabs(jsonData.headerData);
        }

        function flagUnflagTabs(data) {
            if (data.primaryStatus == 'KO') {
                $('#imgDescriptionPrimaryStatus').show();
                $('#imgDescriptionSecondaryStatus').show();
                $("#imgDescriptionPrimaryStatus").attr("title", data.primaryText);
                $("#imgDescriptionSecondaryStatus").attr("title", data.primaryText);
                $("#spanDescriptionPrimaryStatus").text(data.primaryText);
                $("#spanDescriptionSecondaryStatus").text(data.primaryText);
            }
            else {
                $('#imgDescriptionPrimaryStatus').hide();
                $('#imgDescriptionSecondaryStatus').hide();
                $('#spanDescriptionPrimaryStatus').hide();
                $('#spanDescriptionSecondaryStatus').hide();
            }

            if (data.PMRStatus == 'KO') {
                $('#imgDescriptionPMRStatus').show();
                $("#imgDescriptionPMRStatus").attr("title", data.PMRText);
                $("#spanDescriptionGratuityStatus").text(data.PMRText);
            }
            else {
                $('#imgDescriptionPMRStatus').hide();
                $('#spanDescriptionGratuityStatus').hide();
            }

            if (data.CMRStatus == 'KO') {
                $('#imgDescriptionCMRStatus').show();
                $("#imgDescriptionCMRStatus").attr("title", data.CMRText);
                $("#spanDescriptionCMRStatus").text(data.CMRText);
            }
            else {
                $('#imgDescriptionCMRStatus').hide();
                $('#spanDescriptionCMRStatus').hide();
            }

            if (data.ppAaStatus == 'KO') {
                $('#imgDescriptionPpAaStatus').show();
                $("#imgDescriptionPpAaStatus").attr("title", data.ppAaText);
                $("#spanDescriptionPpAaStatus").text(data.ppAaText);
            }
            else {
                $('#imgDescriptionPpAaStatus').hide();
                $('#spanDescriptionPpAaStatus').hide();
            }

            if (data.aaStatus == 'KO') {
                $('#imgDescriptionAaStatus').show();
                $("#imgDescriptionAaStatus").attr("title", data.aaText);
                $("#spanDescriptionAaStatus").text(data.aaText);
            }
            else {
                $('#imgDescriptionAaStatus').hide();
                $('#spanDescriptionAaStatus').hide();
            }

            if (data.gtliStatus == 'KO') {
                $('#imgDescriptionGtliStatus').show();
                $("#imgDescriptionGtliStatus").attr("title", data.gtliText);
                $("#spanDescriptionGtliStatus").text(data.gtliText);
            }
            else {
                $('#imgDescriptionGtliStatus').hide();
                $('#spanDescriptionGtliStatus').hide();
            }

            if (data.gratuityStatus == 'KO') {
                $('#imgDescriptionGratuityStatus').show();
                $("#imgDescriptionGratuityStatus").attr("title", data.gratuityText);
                $("#spanDescriptionGratuityStatus").text(data.gratuityText);
            }
            else {
                $('#imgDescriptionGratuityStatus').hide();
                $('#spanDescriptionGratuityStatus').hide();
            }

            if (data.supAnnuStatus == 'KO') {
                $('#imgDescriptionSupStatus').show();
                $("#imgDescriptionSupStatus").attr("title", data.supAnnuText);
                $("#spanDescriptionSupStatus").text(data.supAnnuText);
            }
            else {
                $('#imgDescriptionSupStatus').hide();
                $('#spanDescriptionSupStatus').hide();
            }

            if (data.epfStatus == 'KO') {
                $('#imgDescriptionEpfStatus').show();
                $("#imgDescriptionEpfStatus").attr("title", data.epfText);
                $("#spanDescriptionEpfStatus").text(data.epfText);
            }
            else {
                $('#imgDescriptionEpfStatus').hide();
                $('#spanDescriptionEpfStatus').hide();
            }
            if (data.epsaStatus == 'KO') {
                $('#imgDescriptionEpsaStatus').show();
                $("#imgDescriptionEpsaStatus").attr("title", data.epsaText);
                $("#spanDescriptionEpsaStatus").text(data.epsaText);
            }
            else {
                $('#imgDescriptionEpsaStatus').hide();
                $('#spanDescriptionEpsaStatus').hide();
            }
            if (data.epsmStatus == 'KO') {
                $('#imgDescriptionEpsmStatus').show();
                $("#imgDescriptionEpsmStatus").attr("title", data.epsmText);
                $("#spanDescriptionEpsmStatus").text(data.epsmText);
            }
            else {
                $('#imgDescriptionEpsmStatus').hide();
                $('#spanDescriptionEpsmStatus').hide();
            }
        }

        function downloadInstructions() {


            $.ajax({
                headers: { "RequestVerificationToken": $('input[name="__RequestVerificationToken"]').val() },
                url: '@Url.Action("DownloadEGIInstructions", "EmpGenInfoDetails", new { Area = "EmpGenInfo" })',
                type: "POST",
                data: {
                },
                cache: false,
                xhr: function () {
                    var xhr = new XMLHttpRequest();
                    xhr.onreadystatechange = function () {
                        if (xhr.readyState == 2) {
                            if (xhr.status == 200) {
                                xhr.responseType = "blob";
                            }
                        }
                    };
                    return xhr;
                },
                beforeSend: function () {
                    showLoader();
                },

                success: function (blob, status, xhr) {

                    var filename = "";
                    var disposition = xhr.getResponseHeader('Content-Disposition');
                    if (disposition && disposition.indexOf('attachment') !== -1) {
                        var filenameRegex = /filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/;
                        var matches = filenameRegex.exec(disposition);
                        if (matches != null && matches[1]) filename = matches[1].replace(/['"]/g, '');
                    }
                    var link = document.createElement('a');
                    var url = window.URL.createObjectURL(blob);

                    link.href = window.URL.createObjectURL(blob);
                    link.download = filename;
                    link.click();
                    link.remove();
                    window.URL.revokeObjectURL(url);
                    toastr.success("File downloaded successfully.");
                    hideLoader();
                },
                error: function (xhr) {
                    showError(xhr);
                    hideLoader();
                }
            });
        }

        function UpdateSelfRecord() {

            var formAction = "UpdateSelfRecord";
            $("#formCMRDetails").attr("action", formAction);

            var frm = $('#formCMRDetails');
            frm.submit();

        }
    </script>
}
