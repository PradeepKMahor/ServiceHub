@using ServiceHub.Domain

@model RoleEdit
@{
    ViewData["Title"] = "UPDATE ROLE";
    int i = 1;
}

@Html.AntiForgeryToken()

@section BreadCrumbs
{
    <ol class="breadcrumb">
        <li class="breadcrumb-item "><a asp-action="Index" asp-controller="Home" asp-area="Admin">Admin</a></li>

        <li class="breadcrumb-item active" aria-current="page">Role list</li>
    </ol>

}

@section Styles {
    <link href="@Url.Content("~/css/drome-style.css")" rel="stylesheet" type="text/css" asp-append-version="true" />
}

<div style="display:none">
</div>

<div class="container-fluid bg-white border card rounded shadow m-auto col-xl-6 p-2 ">
    <div class="app-h4 app-card-header mb-2">
        <p class="h3">Manage Role User : <b>@Model.Role.Name</p>
    </div>
    <div class="bg-gray-active rounded ">
        <form method="post" class="p-2 m-2">
            <div asp-validation-summary="All" class="text-danger"></div>
            <input type="hidden" name="roleName" value="@Model.Role.Name" />
            <input type="hidden" name="roleId" value="@Model.Role.Id" />

            <h3 style="text-align:center" class="bg-info p-1 text-white">
                Add User In Role
            </h3>
            <table id="tbGridAddUsers" class="table table-hover table-bordered table-sm" style="width:100%">
                @if (Model.NonMembers.Count() == 0)
                {
                    <tr>
                        <td colspan="2">All Users Are Members</td>
                    </tr>
                }
                else
                {
                    @foreach (AppUser user in Model.NonMembers)
                    {
                        <tr>
                            <td>@user.UserName</td>
                            <td style="width:100px!important">
                                <input type="checkbox" name="AddIds" value="@user.Id">
                            </td>
                        </tr>
                    }
                }
            </table>

            <h3 style="text-align:center" class="bg-info p-1 text-white">
                Remove User From Role
            </h3>
            <table id="tbGridRemoveUsers" class="table table-hover table-bordered table-sm " style="width:100%">
                @if (Model.Members.Count() == 0)
                {
                    <tr><td colspan="2">No Users Are Members</td></tr>
                }
                else
                {
                    @foreach (AppUser user in Model.Members)
                    {
                        <tr>
                            <td>@user.UserName</td>
                            <td style="width:100px!important">
                                <input type="checkbox" name="DeleteIds" value="@user.Id">
                            </td>
                        </tr>
                    }
                }
            </table>
            <button type="submit" class="btn btn-primary">Save</button>
        </form>

    </div>
</div>
@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script>

        $(document).ready(function () {

             $('#tbGridAddUsers').DataTable({
                pageLength: 25,
                lengthMenu: [25, 50],
                processing: true,
                language: {
                    loadingRecords: '&nbsp;',
                    processing: '<div class="loader"></div>'
                },
                serverSide: false,
                info: true,
                filter: true,
                ordering: true
             });

             $('#tbGridRemoveUsers').DataTable({
                pageLength: 25,
                lengthMenu: [25, 50],
                processing: true,
                language: {
                    loadingRecords: '&nbsp;',
                    processing: '<div class="loader"></div>'
                },
                serverSide: false,
                info: true,
                filter: true,
                ordering: true
             });


        });

        function functionConfirm(event) {
            swal({
                title: 'are you sure?',
                text: "You will not be able to recover this item",
                type: 'warning',
                showCancelButton: true,
                cancelButtonText: 'No',
                cancelButtonClass: 'btn btn-danger mr-2 ml-2',
                showConfirmButton: true,
                confirmButtonText: 'Yes',
                confirmButtonClass: 'btn btn-success mr-2 ml-2'
            }, function (isConfirm) {
                if (isConfirm) {
                    this.submit();
                    return true;
                } else {
                    return false;
                }
            });
            return false;
        }
    </script>

}